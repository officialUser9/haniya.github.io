"use strict";(self.webpackChunkmodernize=self.webpackChunkmodernize||[]).push([[78],{2697:(e,t,a)=>{a.r(t),a.d(t,{default:()=>B});var n=a(9950),i=a(9246),o=a(7233),r=a(2346),s=a(4341),l=a(2145),d=a(6059),c=a(736),u=a(7987),h=a(7535),x=a(397),g=a(4965),m=a(371),p=a(8605),A=a(2057),v=a(6125),f=a(7299),j=a(7335),y=a(8279),b=a(6583),w=a(33),S=a(9329),I=a(6601),C=a(8429),L=a(4695),P=a.n(L),_=a(8095),W=a(9928),k=a(2180),E=(a(7705),a(3729)),T=a(4414);const B=()=>{(0,C.Zp)();const[e,t]=(0,n.useState)([]),[a,L]=(0,n.useState)(!1),[B,R]=(0,n.useState)(null),[z,N]=(0,n.useState)(!1),[q,O]=(0,n.useState)(""),[F,M]=(0,n.useState)(!1),[U,V]=(0,n.useState)(null),[Z,D]=(0,n.useState)(""),[$,G]=(0,n.useState)(1),[H,J]=(0,n.useState)(0),[K,Q]=(0,n.useState)(10),[X,Y]=(0,n.useState)({first_name:"",last_name:"",email:"",password:"",phone:""}),[ee,te]=(0,n.useState)({first_name:"",last_name:"",email:"",password:"",phone:"",otp:""}),[ae,ne]=(0,n.useState)("all");(0,n.useEffect)((()=>{ie()}),[ae]);const ie=async()=>{L(!0);try{const e=await i.A.get("http://134.209.145.149:9999/api/listUser?role_id=3",{params:{status:ae}});t(e.data.users),J(e.data.total_users)}catch(e){R(e)}finally{L(!1)}},oe=()=>{N(!1),Y({first_name:"",last_name:"",email:"",password:"",phone:""}),M(!1),D("")},re=e=>{Y({...X,[e.target.name]:e.target.value})},se=null===e||void 0===e?void 0:e.filter((e=>{var t,a,n,i,o,r,s,l;return("all"===ae||1===ae&&(null===e||void 0===e?void 0:e.status)||0===ae&&!e.status)&&((null===e||void 0===e||null===(t=e.first_name)||void 0===t||null===(a=t.toLowerCase())||void 0===a?void 0:a.includes(null===q||void 0===q?void 0:q.toLowerCase()))||(null===e||void 0===e||null===(n=e.last_name)||void 0===n||null===(i=n.toLowerCase())||void 0===i?void 0:i.includes(null===q||void 0===q?void 0:q.toLowerCase()))||(null===e||void 0===e||null===(o=e.email)||void 0===o||null===(r=o.toLowerCase())||void 0===r?void 0:r.includes(null===q||void 0===q?void 0:q.toLowerCase()))||(null===e||void 0===e||null===(s=e.phone)||void 0===s||null===(l=s.toLowerCase())||void 0===l?void 0:l.includes(null===q||void 0===q?void 0:q.toLowerCase())))}));return B?(0,T.jsxs)(o.A,{children:["Error: ",B.message]}):Array.isArray(e)?(0,T.jsxs)(W.A,{children:[(0,T.jsx)(k.N9,{}),(0,T.jsxs)(r.A,{sx:{display:"flex",alignItems:"center",mb:2},children:[(0,T.jsx)(o.A,{variant:"h3",component:"h2",sx:{flex:1},children:"Agent List"}),(0,T.jsxs)(r.A,{sx:{display:"flex",gap:2},children:[(0,T.jsx)(s.A,{size:"medium",label:"Search Agents",variant:"outlined",value:q,onChange:e=>O(e.target.value)}),(0,T.jsxs)(l.A,{variant:"outlined",size:"medium",children:[(0,T.jsx)(d.A,{children:"Select"}),(0,T.jsxs)(c.A,{value:ae,onChange:e=>{ne(e.target.value)},label:"Select",sx:{height:"100%",minWidth:"120px"},children:[(0,T.jsx)(u.A,{value:"all",children:"All"}),(0,T.jsx)(u.A,{value:1,children:"Active"}),(0,T.jsx)(u.A,{value:0,children:"Inactive"})]})]}),(0,T.jsx)(h.A,{variant:"contained",color:"primary",size:"large",onClick:()=>{N(!0),te({first_name:"",last_name:"",email:"",password:"",phone:"",otp:""})},children:"Add Agent"})]})]}),(0,T.jsxs)(r.A,{sx:{overflow:"auto",width:{xs:"280px",sm:"auto"}},children:[(0,T.jsxs)(x.A,{"aria-label":"simple table",sx:{whiteSpace:"nowrap",mt:2},children:[(0,T.jsx)(g.A,{children:(0,T.jsxs)(m.A,{children:[(0,T.jsx)(p.A,{sx:{backgroundColor:"#f5f5f5"},children:(0,T.jsx)(o.A,{variant:"subtitle2",fontWeight:600,children:"Id"})}),(0,T.jsx)(p.A,{sx:{backgroundColor:"#f5f5f5"},children:(0,T.jsx)(o.A,{variant:"subtitle2",fontWeight:600,children:"Name"})}),(0,T.jsx)(p.A,{sx:{backgroundColor:"#f5f5f5"},children:(0,T.jsx)(o.A,{variant:"subtitle2",fontWeight:600,children:"Email"})}),(0,T.jsx)(p.A,{sx:{backgroundColor:"#f5f5f5"},children:(0,T.jsx)(o.A,{variant:"subtitle2",fontWeight:600,children:"Phone"})}),(0,T.jsx)(p.A,{sx:{backgroundColor:"#f5f5f5"},children:(0,T.jsx)(o.A,{variant:"subtitle2",fontWeight:600,children:"Status"})}),(0,T.jsx)(p.A,{sx:{backgroundColor:"#f5f5f5"},children:(0,T.jsx)(o.A,{variant:"subtitle2",fontWeight:600,children:"Action"})})]})}),(0,T.jsx)(A.A,{children:a?Array.from({length:5}).map(((e,t)=>(0,T.jsxs)(m.A,{children:[(0,T.jsx)(p.A,{children:(0,T.jsx)(v.A,{variant:"text"})}),(0,T.jsx)(p.A,{children:(0,T.jsx)(v.A,{variant:"text"})}),(0,T.jsx)(p.A,{children:(0,T.jsx)(v.A,{variant:"text"})}),(0,T.jsx)(p.A,{children:(0,T.jsx)(v.A,{variant:"text"})}),(0,T.jsx)(p.A,{children:(0,T.jsx)(v.A,{variant:"text"})}),(0,T.jsx)(p.A,{children:(0,T.jsx)(v.A,{variant:"text"})})]},t))):se.map(((a,n)=>(0,T.jsxs)(m.A,{children:[(0,T.jsx)(p.A,{children:(0,T.jsx)(o.A,{variant:"subtitle2",children:n+1})}),(0,T.jsx)(p.A,{children:(0,T.jsxs)(o.A,{variant:"subtitle2",children:[a.first_name," ",a.last_name]})}),(0,T.jsx)(p.A,{children:(0,T.jsx)(o.A,{color:"textSecondary",variant:"subtitle2",children:a.email})}),(0,T.jsx)(p.A,{children:(0,T.jsx)(o.A,{color:"textSecondary",variant:"subtitle2",children:a.phone})}),(0,T.jsx)(p.A,{children:(0,T.jsx)(f.A,{label:a.status?"Active":"Inactive",color:a.status?"success":"error",sx:{borderRadius:"4px",fontSize:"0.8rem"}})}),(0,T.jsx)(p.A,{children:(0,T.jsx)(j.A,{checked:a.status,onChange:()=>(async(a,n)=>{try{const o=e.map((e=>e.id===a?{...e,status:!n}:e));t(o),await i.A.put("http://134.209.145.149:9999/api/toggle_user_status/".concat(a)),P().fire({icon:"success",title:"Status Updated",text:"".concat(o.find((e=>e.id===a)).first_name," is now ").concat(n?"inactive":"active",".")}),ie()}catch(o){ie(),P().fire({icon:"error",title:"Error",text:"Failed to update agent status."})}})(a.id,a.status),color:"primary"})})]},a.id)))})]}),0===se.length&&!a&&(0,T.jsx)(r.A,{display:"flex",justifyContent:"center",alignItems:"center",height:"100%",children:(0,T.jsx)("img",{height:"400px",src:E,alt:"No data"})})]}),(0,T.jsx)(r.A,{sx:{display:"flex",justifyContent:"center",mt:3},children:(0,T.jsx)(y.A,{count:Math.ceil(H/K),page:$,onChange:(e,t)=>{G(t)},color:"primary"})}),(0,T.jsxs)(b.A,{open:z,onClose:oe,maxWidth:"sm",fullWidth:!0,children:[(0,T.jsx)(w.A,{children:"Add New Agent"}),(0,T.jsx)(S.A,{children:(0,T.jsxs)(r.A,{component:"form",noValidate:!0,children:[(0,T.jsx)(s.A,{margin:"dense",name:"first_name",label:"First Name",type:"text",fullWidth:!0,value:X.first_name,onChange:re,error:Boolean(ee.first_name),helperText:ee.first_name}),(0,T.jsx)(s.A,{margin:"dense",name:"last_name",label:"Last Name",type:"text",fullWidth:!0,value:X.last_name,onChange:re,error:Boolean(ee.last_name),helperText:ee.last_name}),(0,T.jsx)(s.A,{margin:"dense",name:"email",label:"Email",type:"email",fullWidth:!0,value:X.email,onChange:re,error:Boolean(ee.email),helperText:ee.email}),(0,T.jsx)(s.A,{margin:"dense",name:"password",label:"Password",type:"password",fullWidth:!0,value:X.password,onChange:re,error:Boolean(ee.password),helperText:ee.password}),(0,T.jsx)(s.A,{margin:"dense",name:"phone",label:"Phone",type:"number",fullWidth:!0,value:X.phone,onChange:re,error:Boolean(ee.phone),helperText:ee.phone}),F&&(0,T.jsx)(s.A,{margin:"dense",name:"otp",label:"OTP",type:"number",fullWidth:!0,value:Z,onChange:e=>D(e.target.value),error:Boolean(ee.otp),helperText:ee.otp})]})}),(0,T.jsxs)(I.A,{children:[(0,T.jsx)(h.A,{onClick:oe,children:"Cancel"}),F?(0,T.jsx)(_.A,{onClick:async()=>{if(Z.trim()){L(!0);try{await i.A.post("http://134.209.145.149:9999/api/verify-otp",{user_id:U,otp_code:Z}),k.oR.success("OTP verified successfully"),oe(),ie()}catch(B){k.oR.error("Failed to verify OTP.")}finally{L(!1)}}else te((e=>({...e,otp:"OTP is required"})))},loading:a,variant:"contained",color:"primary",children:"Verify OTP"}):(0,T.jsx)(_.A,{onClick:async()=>{if((()=>{let e=!0;const t={};return X.first_name.trim()||(t.first_name="First Name is required",e=!1),X.last_name.trim()||(t.last_name="Last Name is required",e=!1),X.email.trim()?/\S+@\S+\.\S+/.test(X.email)||(t.email="Email is not valid",e=!1):(t.email="Email is required",e=!1),X.password.trim()?/(?=.*[A-Za-z])(?=.*\W).{6,}/.test(X.password)||(t.password="Password must contain at least one alphabet, one special character, and be at least 6 characters long",e=!1):(t.password="Password is required",e=!1),X.phone.trim()?/^\d{10}$/.test(X.phone)||(t.phone="Invalid phone number format",e=!1):(t.phone="Phone is required",e=!1),F&&(Z.trim()||(t.otp="OTP is required",e=!1)),te(t),e})()){L(!0);try{const e=await i.A.post("http://134.209.145.149:9999/api/register",{...X,role_id:3});V(e.data.uid),k.oR.success("Agent created successfully! Please verify the OTP sent to your email."),M(!0)}catch(B){B.response&&B.response.data&&"Username already exists"===B.response.data.message?k.oR.error("Username already exists. Please choose a different username."):k.oR.error("Failed to create agent.")}finally{L(!1)}}},loading:a,variant:"contained",color:"primary",children:"Create Agent"})]})]})]}):(0,T.jsx)(o.A,{children:"Error: Unexpected data format"})}},8095:(e,t,a)=>{a.d(t,{A:()=>j});var n=a(8587),i=a(8168),o=a(9950),r=a(1676),s=a(1014),l=a(8465),d=a(9254),c=a(664),u=a(7535),h=a(8623),x=a(423);function g(e){return(0,x.Ay)("MuiLoadingButton",e)}const m=(0,a(1763).A)("MuiLoadingButton",["root","loading","loadingIndicator","loadingIndicatorCenter","loadingIndicatorStart","loadingIndicatorEnd","endIconLoadingEnd","startIconLoadingStart"]);var p=a(4414);const A=["children","disabled","id","loading","loadingIndicator","loadingPosition","variant"],v=(0,d.Ay)(u.A,{shouldForwardProp:e=>(e=>"ownerState"!==e&&"theme"!==e&&"sx"!==e&&"as"!==e&&"classes"!==e)(e)||"classes"===e,name:"MuiLoadingButton",slot:"Root",overridesResolver:(e,t)=>[t.root,t.startIconLoadingStart&&{["& .".concat(m.startIconLoadingStart)]:t.startIconLoadingStart},t.endIconLoadingEnd&&{["& .".concat(m.endIconLoadingEnd)]:t.endIconLoadingEnd}]})((e=>{let{ownerState:t,theme:a}=e;return(0,i.A)({["& .".concat(m.startIconLoadingStart,", & .").concat(m.endIconLoadingEnd)]:{transition:a.transitions.create(["opacity"],{duration:a.transitions.duration.short}),opacity:0}},"center"===t.loadingPosition&&{transition:a.transitions.create(["background-color","box-shadow","border-color"],{duration:a.transitions.duration.short}),["&.".concat(m.loading)]:{color:"transparent"}},"start"===t.loadingPosition&&t.fullWidth&&{["& .".concat(m.startIconLoadingStart,", & .").concat(m.endIconLoadingEnd)]:{transition:a.transitions.create(["opacity"],{duration:a.transitions.duration.short}),opacity:0,marginRight:-8}},"end"===t.loadingPosition&&t.fullWidth&&{["& .".concat(m.startIconLoadingStart,", & .").concat(m.endIconLoadingEnd)]:{transition:a.transitions.create(["opacity"],{duration:a.transitions.duration.short}),opacity:0,marginLeft:-8}})})),f=(0,d.Ay)("div",{name:"MuiLoadingButton",slot:"LoadingIndicator",overridesResolver:(e,t)=>{const{ownerState:a}=e;return[t.loadingIndicator,t["loadingIndicator".concat((0,r.A)(a.loadingPosition))]]}})((e=>{let{theme:t,ownerState:a}=e;return(0,i.A)({position:"absolute",visibility:"visible",display:"flex"},"start"===a.loadingPosition&&("outlined"===a.variant||"contained"===a.variant)&&{left:"small"===a.size?10:14},"start"===a.loadingPosition&&"text"===a.variant&&{left:6},"center"===a.loadingPosition&&{left:"50%",transform:"translate(-50%)",color:(t.vars||t).palette.action.disabled},"end"===a.loadingPosition&&("outlined"===a.variant||"contained"===a.variant)&&{right:"small"===a.size?10:14},"end"===a.loadingPosition&&"text"===a.variant&&{right:6},"start"===a.loadingPosition&&a.fullWidth&&{position:"relative",left:-10},"end"===a.loadingPosition&&a.fullWidth&&{position:"relative",right:-10})})),j=o.forwardRef((function(e,t){const a=(0,c.A)({props:e,name:"MuiLoadingButton"}),{children:o,disabled:d=!1,id:u,loading:x=!1,loadingIndicator:m,loadingPosition:j="center",variant:y="text"}=a,b=(0,n.A)(a,A),w=(0,s.A)(u),S=null!=m?m:(0,p.jsx)(h.A,{"aria-labelledby":w,color:"inherit",size:16}),I=(0,i.A)({},a,{disabled:d,loading:x,loadingIndicator:S,loadingPosition:j,variant:y}),C=(e=>{const{loading:t,loadingPosition:a,classes:n}=e,o={root:["root",t&&"loading"],startIcon:[t&&"startIconLoading".concat((0,r.A)(a))],endIcon:[t&&"endIconLoading".concat((0,r.A)(a))],loadingIndicator:["loadingIndicator",t&&"loadingIndicator".concat((0,r.A)(a))]},s=(0,l.A)(o,g,n);return(0,i.A)({},n,s)})(I),L=x?(0,p.jsx)(f,{className:C.loadingIndicator,ownerState:I,children:S}):null;return(0,p.jsxs)(v,(0,i.A)({disabled:d||x,id:w,ref:t},b,{variant:y,classes:C,ownerState:I,children:["end"===I.loadingPosition?o:L,"end"===I.loadingPosition?L:o]}))}))},3729:(e,t,a)=>{e.exports=a.p+"static/media/NoData.d7d252633249b13476cc.jpg"}}]);