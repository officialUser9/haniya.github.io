"use strict";(self.webpackChunkmodernize=self.webpackChunkmodernize||[]).push([[697],{697:(e,s,n)=>{n.r(s),n.d(s,{default:()=>f});var i=n(9950),t=n(7233),r=n(2346),o=n(2145),c=n(6059),a=n(736),l=n(7987),d=n(2633),h=n(4139),m=n(9614),x=n(1496),A=n(7535),p=n(9928),j=n(2180),u=(n(7705),n(8429)),y=n(4414);const f=()=>{const[e,s]=(0,i.useState)([]),[n,f]=(0,i.useState)([]),[g,v]=(0,i.useState)(!0);(0,u.Zp)();(0,i.useEffect)((()=>{(async()=>{try{const e=await fetch("http://134.209.145.149:9999/api/menuList"),n=await e.json();if(n.success){const e=n.data.map((e=>e.name)),i=e.map((()=>({AD:!1,CU:!1,AG:!1})));f(e),s(i)}else console.error("Failed to fetch data:",n.success)}catch(e){console.error("Error fetching names:",e)}finally{v(!1)}})()}),[]),(0,i.useEffect)((()=>{n.length>0&&(async()=>{try{const i=await fetch("http://134.209.145.149:9999/api/getPermissions"),t=await i.json();if(t){const i=e.map(((e,s)=>{const i=n[s],r=t.filter((e=>e.menu_name===i)),o={AD:!1,CU:!1,AG:!1};return r.forEach((e=>{o[e.role_type]=!0})),o}));s(i)}else console.error("Failed to fetch permissions")}catch(i){console.error("Error fetching permissions:",i)}})()}),[n]);const C=(n,i)=>t=>{const r=[...e];r[n]={...r[n],[i]:t.target.checked},s(r)};return g?(0,y.jsx)(t.A,{variant:"body1",children:"Loading..."}):(0,y.jsxs)(p.A,{children:[(0,y.jsx)(j.N9,{}),(0,y.jsxs)(r.A,{sx:{display:"flex",alignItems:"center",mb:2},children:[(0,y.jsx)(t.A,{variant:"h3",component:"h2",sx:{flex:1},children:"Permission"}),(0,y.jsx)(r.A,{sx:{display:"flex",gap:2},children:(0,y.jsxs)(o.A,{variant:"outlined",size:"medium",children:[(0,y.jsx)(c.A,{children:"Select User"}),(0,y.jsxs)(a.A,{label:"Select User",sx:{height:"100%",minWidth:"220px"},children:[(0,y.jsx)(l.A,{value:12,children:"Admin"}),(0,y.jsx)(l.A,{value:1,children:"Agent"}),(0,y.jsx)(l.A,{value:0,children:"Customer"})]})]})})]}),(0,y.jsxs)(d.A,{children:[(0,y.jsx)(h.Ay,{container:!0,spacing:2,children:n.map(((s,n)=>{var i,r,o;return(0,y.jsx)(h.Ay,{item:!0,xs:12,children:(0,y.jsxs)(h.Ay,{container:!0,alignItems:"center",spacing:2,children:[(0,y.jsx)(h.Ay,{item:!0,xs:3,children:(0,y.jsx)(t.A,{variant:"body1",children:s})}),(0,y.jsx)(h.Ay,{item:!0,xs:9,children:(0,y.jsxs)(h.Ay,{container:!0,spacing:1,justifyContent:"flex-end",children:[(0,y.jsx)(h.Ay,{item:!0,children:(0,y.jsx)(m.A,{control:(0,y.jsx)(x.A,{checked:(null===(i=e[n])||void 0===i?void 0:i.AD)||!1,onChange:C(n,"AD"),color:"primary"}),label:"AD"})}),(0,y.jsx)(h.Ay,{item:!0,children:(0,y.jsx)(m.A,{control:(0,y.jsx)(x.A,{checked:(null===(r=e[n])||void 0===r?void 0:r.CU)||!1,onChange:C(n,"CU"),color:"primary"}),label:"CU"})}),(0,y.jsx)(h.Ay,{item:!0,children:(0,y.jsx)(m.A,{control:(0,y.jsx)(x.A,{checked:(null===(o=e[n])||void 0===o?void 0:o.AG)||!1,onChange:C(n,"AG"),color:"primary"}),label:"AG"})})]})})]})},n)}))}),(0,y.jsx)(A.A,{variant:"contained",color:"primary",onClick:async()=>{const s=n.map(((s,n)=>({name:s,permissions:{AD:e[n].AD,CU:e[n].CU,AG:e[n].AG}})));try{const e=await fetch("http://134.209.145.149:9999/api/dPermission",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(s)}),n=await e.json();e.ok?(j.oR.success("Permissions updated successfully!"),setTimeout((()=>{window.location.reload()}),3e3)):j.oR.error("Failed to update permissions: ".concat(n.message))}catch(i){j.oR.error("Error submitting permissions")}},sx:{marginTop:"16px",float:"right",marginBottom:"16px"},children:"Submit"})]})]})}}}]);